# 

data = '''#############################################################################################################################################
#...#...#...#...#...#.....#.........###...#####...###.....#.....#.........###...###...#####...###...#.....###...#.............###...###.....#
#.#.#.#.#.#.#.#.#.#.#.###.#.#######.###.#.#####.#.###.###.#.###.#.#######.###.#.###.#.#####.#.###.#.#.###.###.#.#.###########.###.#.###.###.#
#.#.#.#.#.#...#...#...#...#.......#.#...#...#...#...#...#.#...#...#.......#...#.#...#...#...#.#...#.#.#...#...#.#.#.........#.#...#.#...#...#
#.#.#.#.#.#############.#########.#.#.#####.#.#####.###.#.###.#####.#######.###.#.#####.#.###.#.###.#.#.###.###.#.#.#######.#.#.###.#.###.###
#.#.#.#.#.........#.....###.......#.#...#...#...#...#...#.###.....#.#...#...#...#.....#.#.#...#...#...#...#...#...#.......#...#.#...#...#...#
#.#.#.#.#########.#.#######.#######.###.#.#####.#.###.###.#######.#.#.#.#.###.#######.#.#.#.#####.#######.###.###########.#####.#.#####.###.#
#.#...#.#...#.....#...#...#.......#.....#...###.#...#...#...#.....#...#...#...#...###.#...#.....#.......#.....#.........#.#...#.#.....#...#.#
#.#####.#.#.#.#######.#.#.#######.#########.###.###.###.###.#.#############.###.#.###.#########.#######.#######.#######.#.#.#.#.#####.###.#.#
#.....#...#.#.......#...#.###...#.........#...#...#...#.#...#.....#...#...#.#...#.....#.........#...###.....#...#...###.#...#.#.....#.....#.#
#####.#####.#######.#####.###.#.#########.###.###.###.#.#.#######.#.#.#.#.#.#.#########.#########.#.#######.#.###.#.###.#####.#####.#######.#
#...#.....#.#...#...#.....#...#.......###.#...###...#.#.#.#...###.#.#...#.#.#.........#...#...#...#.#.......#.###.#...#.......#.....#.......#
#.#.#####.#.#.#.#.###.#####.#########.###.#.#######.#.#.#.#.#.###.#.#####.#.#########.###.#.#.#.###.#.#######.###.###.#########.#####.#######
#.#.###...#.#.#.#...#.....#.#.......#.#...#...###...#.#.#.#.#.#...#...###...###...###.#...#.#.#...#.#.......#.....#...#...#...#.....#.......#
#.#.###.###.#.#.###.#####.#.#.#####.#.#.#####.###.###.#.#.#.#.#.#####.#########.#.###.#.###.#.###.#.#######.#######.###.#.#.#.#####.#######.#
#.#...#.#...#.#.#...#.....#...#...#.#.#.....#...#...#...#...#.#.....#...#...#...#.#...#...#.#...#.#...###...#.......###.#...#...#...#.......#
#.###.#.#.###.#.#.###.#########.#.#.#.#####.###.###.#########.#####.###.#.#.#.###.#.#####.#.###.#.###.###.###.#########.#######.#.###.#######
#...#.#.#.#...#.#...#.###.....#.#...#...###.#...#...#...#.....#...#.#...#.#.#...#.#.....#.#...#.#...#...#...#.........#...#.....#...#.###...#
###.#.#.#.#.###.###.#.###.###.#.#######.###.#.###.###.#.#.#####.#.#.#.###.#.###.#.#####.#.###.#.###.###.###.#########.###.#.#######.#.###.#.#
#...#...#.#...#.....#...#...#.#.....#...#...#...#.....#.#.#...#.#.#.#...#.#.#...#.#...#.#...#.#...#.#...#...#...#.....###.#...#.....#.....#.#
#.#######.###.#########.###.#.#####.#.###.#####.#######.#.#.#.#.#.#.###.#.#.#.###.#.#.#.###.#.###.#.#.###.###.#.#.#######.###.#.###########.#
#.......#.###.........#...#.#.....#.#.###.....#...#...#.#.#.#.#.#.#.#...#.#.#...#.#.#.#.#...#...#.#.#...#...#.#...###.....#...#...#.........#
#######.#.###########.###.#.#####.#.#.#######.###.#.#.#.#.#.#.#.#.#.#.###.#.###.#.#.#.#.#.#####.#.#.###.###.#.#######.#####.#####.#.#########
#.......#.....#.......#...#.....#.#.#.#...#...#...#.#...#...#...#.#.#.#...#.#...#...#.#.#.#...#.#.#.#...#...#.###...#...#...#.....#.........#
#.###########.#.#######.#######.#.#.#.#.#.#.###.###.#############.#.#.#.###.#.#######.#.#.#.#.#.#.#.#.###.###.###.#.###.#.###.#############.#
#.......#...#.#.......#.....#...#...#.#.#.#.#...###.....#.........#.#.#...#.#.#.......#.#.#.#.#.#.#.#...#...#.....#.....#...#...#...........#
#######.#.#.#.#######.#####.#.#######.#.#.#.#.#########.#.#########.#.###.#.#.#.#######.#.#.#.#.#.#.###.###.###############.###.#.###########
#...###...#.#.#...###...#...#.......#.#.#.#.#.#...#...#.#...#.....#.#...#.#.#.#.#...#...#.#.#...#.#...#.....#...............#...#...........#
#.#.#######.#.#.#.#####.#.#########.#.#.#.#.#.#.#.#.#.#.###.#.###.#.###.#.#.#.#.#.#.#.###.#.#####.###.#######.###############.#############.#
#.#.........#.#.#.#...#.#.....#...#.#...#...#.#.#.#.#.#.#...#...#.#.#...#.#.#.#.#.#.#.#...#...#...###.#...#...#...#...#...#...#...#.......#.#
#.###########.#.#.#.#.#.#####.#.#.#.#########.#.#.#.#.#.#.#####.#.#.#.###.#.#.#.#.#.#.#.#####.#.#####.#.#.#.###.#.#.#.#.#.#.###.#.#.#####.#.#
#.#.........#.#.#.#.#...#.....#.#.#.....#...#...#...#.#.#.#...#.#.#.#...#.#.#.#.#.#.#.#.....#.#.#...#...#.#.....#...#...#...#...#.#...#...#.#
#.#.#######.#.#.#.#.#####.#####.#.#####.#.#.#########.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#####.#.#.#.#.#####.###################.###.###.#.###.#
#...#.......#...#...#...#.....#.#.#...#...#...#.......#.#.#.#.#.#.#.#...#.#.#.#.#.#.#...#...#.#.#.#.###...#...#.......#...#...###.#...#.....#
#####.###############.#.#####.#.#.#.#.#######.#.#######.#.#.#.#.#.#.#.###.#.#.#.#.#.###.#.###.#.#.#.###.###.#.#.#####.#.#.#.#####.#.#########
#...#.....#...#...#...#...#...#.#.#.#.#...#...#.....#...#.#.#.#.#.#.#.#...#.#.#.#.#...#.#.#...#.#.#.#...#...#...#...#...#.#.....#.#.........#
#.#.#####.#.#.#.#.#.#####.#.###.#.#.#.#.#.#.#######.#.###.#.#.#.#.#.#.#.###.#.#.#.###.#.#.#.###.#.#.#.###.#######.#.#####.#####.#.#########.#
#.#.......#.#...#...###...#.....#...#...#.#...#.....#.###.#.#.#.#.#.#.#.###...#.#.###.#.#.#.#...#.#.#.#...#.....#.#.#...#.......#...........#
#.#########.###########.#################.###.#.#####.###.#.#.#.#.#.#.#.#######.#.###.#.#.#.#.###.#.#.#.###.###.#.#.#.#.#####################
#.#...#...#.#...........#...#...........#.#...#.....#...#.#.#.#.#.#.#...#...#...#.#...#.#...#.#...#...#...#...#.#.#.#.#.....#...#.......#...#
#.#.#.#.#.#.#.###########.#.#.#########.#.#.#######.###.#.#.#.#.#.#.#####.#.#.###.#.###.#####.#.#########.###.#.#.#.#.#####.#.#.#.#####.#.#.#
#...#.#.#...#...........#.#.#.#...#.....#.#...#.....#...#.#.#.#.#.#...#...#...#...#...#.....#...#...#...#.....#...#...#...#.#.#...#.....#.#.#
#####.#.###############.#.#.#.#.#.#.#####.###.#.#####.###.#.#.#.#.###.#.#######.#####.#####.#####.#.#.#.###############.#.#.#.#####.#####.#.#
#...#...#...#.......#...#.#.#.#.#...#...#.#...#...#...#...#.#.#.#.#...#.#...#...#.....#...#.###...#...#.................#...#.#.....#...#.#.#
#.#.#####.#.#.#####.#.###.#.#.#.#####.#.#.#.#####.#.###.###.#.#.#.#.###.#.#.#.###.#####.#.#.###.#############################.#.#####.#.#.#.#
#.#.###...#.#.#...#...#...#.#.#.#.....#.#.#...#...#.###.....#...#.#...#.#.#.#.###.....#.#.#...#.#.....................#...###.#.......#.#.#.#
#.#.###.###.#.#.#.#####.###.#.#.#.#####.#.###.#.###.#############.###.#.#.#.#.#######.#.#.###.#.#.###################.#.#.###.#########.#.#.#
#.#...#...#.#...#.......###...#...#.....#.....#.#...#.....#.......#...#.#.#.#.#.......#.#.#...#...#.................#...#...#.#.......#...#.#
#.###.###.#.#######################.###########.#.###.###.#.#######.###.#.#.#.#.#######.#.#.#######.###############.#######.#.#.#####.#####.#
#...#.#...#...#...#.......#.......#.........###.#.#...#...#.......#...#.#.#.#.#.....#...#.#...#...#...#...#.......#.#.....#...#.....#...#...#
###.#.#.#####.#.#.#.#####.#.#####.#########.###.#.#.###.#########.###.#.#.#.#.#####.#.###.###.#.#.###.#.#.#.#####.#.#.###.#########.###.#.###
#...#...#...#.#.#.#.....#.#.....#.........#...#...#.#...#.....###.#...#...#...#.....#...#.#...#.#...#...#...#.....#...###.....#.....#...#...#
#.#######.#.#.#.#.#####.#.#####.#########.###.#####.#.###.###.###.#.###########.#######.#.#.###.###.#########.###############.#.#####.#####.#
#...#...#.#.#...#.....#.#.#...#.........#...#.......#.###...#.....#.......#.....#.....#.#...###...#.#.........#.....#...#...#...#...#...#...#
###.#.#.#.#.#########.#.#.#.#.#########.###.#########.#####.#############.#.#####.###.#.#########.#.#.#########.###.#.#.#.#.#####.#.###.#.###
###...#.#.#...#.....#.#.#.#.#.#.........###.......#...#...#...#.....#...#.#.#...#.###...#...###...#.#...........#...#.#...#.......#...#.#.###
#######.#.###.#.###.#.#.#.#.#.#.#################.#.###.#.###.#.###.#.#.#.#.#.#.#.#######.#.###.###.#############.###.###############.#.#.###
#...###...#...#...#.#...#...#...#.......#.......#...###.#.###...###.#.#...#...#...#.......#...#...#.#...#...#...#.....#...#...........#.#...#
#.#.#######.#####.#.#############.#####.#.#####.#######.#.#########.#.#############.#########.###.#.#.#.#.#.#.#.#######.#.#.###########.###.#
#.#.#...###...#...#.........#.....#...#...#.....#...#...#.......#...#.........###...#...#...#...#.#...#...#.#.#.#.......#.#...........#.#...#
#.#.#.#.#####.#.###########.#.#####.#.#####.#####.#.#.#########.#.###########.###.###.#.#.#.###.#.#########.#.#.#.#######.###########.#.#.###
#.#.#.#.#...#...#...........#.#.....#.....#.#...#.#...#.........#.....#.......#...#...#...#...#.#.........#...#.#.......#.............#...###
#.#.#.#.#.#.#####.###########.#.#########.#.#.#.#.#####.#############.#.#######.###.#########.#.#########.#####.#######.#####################
#.#.#.#.#.#.......#.....#...#.#.........#.#...#...#...#.............#...#.......#...#.........#.....#.....#...#.....#...#...................#
#.#.#.#.#.#########.###.#.#.#.#########.#.#########.#.#############.#####.#######.###.#############.#.#####.#.#####.#.###.#################.#
#.#...#...#...#...#.###...#...#.........#.........#.#...#...#...#...#...#.....#...###.....#.......#.#.....#.#.#...#...###.....#.............#
#.#########.#.#.#.#.###########.#################.#.###.#.#.#.#.#.###.#.#####.#.#########.#.#####.#.#####.#.#.#.#.###########.#.#############
#.#...#...#.#.#.#.#.#...#...###...........#.....#...###...#...#.#...#.#.#...#...###.....#...#.....#.#...#.#.#...#...###...#...#.......#.....#
#.#.#.#.#.#.#.#.#.#.#.#.#.#.#############.#.###.###############.###.#.#.#.#.#######.###.#####.#####.#.#.#.#.#######.###.#.#.#########.#.###.#
#...#.#.#.#.#.#.#...#.#...#...............#...#...............#...#.#.#...#.###...#.#...#...#.....#...#...#.#.....#...#.#.#...#.......#.#...#
#####.#.#.#.#.#.#####.#######################.###############.###.#.#.#####.###.#.#.#.###.#.#####.#########.#.###.###.#.#.###.#.#######.#.###
###...#.#.#.#.#.###...#.....#...#...###...#...#...............###...#.#...#...#.#.#.#.#...#.......#.........#.###...#...#.....#.........#...#
###.###.#.#.#.#.###.###.###.#.#.#.#.###.#.#.###.#####################.#.#.###.#.#.#.#.#.###########.#########.#####.#######################.#
#...#...#...#...#...#...###.#.#...#...#.#.#...#...#.....#.........###...#...#.#.#...#.#.............#...#...#.....#.#...#...............#...#
#.###.###########.###.#####.#.#######.#.#.###.###.#.###.#.#######.#########.#.#.#####.###############.#.#.#.#####.#.#.#.#.#############.#.###
#.....#...#...###.....#...#...###.....#.#...#.#...#.#...#.#.......#...#####.#.#.....#.###.....#.......#...#.......#...#.#.............#.#...#
#######.#.#.#.#########.#.#######.#####.###.#.#.###.#.###.#.#######.#.#####.#.#####.#.###.###.#.#######################.#############.#.###.#
#.....#.#...#...#...#...#.......#...###.#...#.#.....#.....#.....#...#...#...#...#...#...#...#.#.......................#...#.....#.....#.....#
#.###.#.#######.#.#.#.#########.###.###.#.###.#################.#.#####.#.#####.#.#####.###.#.#######################.###.#.###.#.###########
#...#.#.#.......#.#.#.........#.###.....#.....#############S....#.....#.#.....#.#.....#.....#.........................###.#...#...#.....#...#
###.#.#.#.#######.#.#########.#.#####################################.#.#####.#.#####.###################################.###.#####.###.#.#.#
#...#...#...###...#...#.......#.#######################...###...###...#.#...#.#.#...#.....#...#...#...#...#.............#...#.......#...#.#.#
#.#########.###.#####.#.#######.#######################.#.###.#.###.###.#.#.#.#.#.#.#####.#.#.#.#.#.#.#.#.#.###########.###.#########.###.#.#
#...#.....#...#.....#.#.......#.#######################.#...#.#.....#...#.#.#.#...#.#.....#.#.#.#.#.#...#...#...#.....#...#.........#.....#.#
###.#.###.###.#####.#.#######.#.#######################.###.#.#######.###.#.#.#####.#.#####.#.#.#.#.#########.#.#.###.###.#########.#######.#
###...###...#...#...#.........#.......#############.....#...#...#...#...#.#.#.#.....#.#.....#...#...###.......#.#...#.....###.....#.........#
###########.###.#.###################.#############.#####.#####.#.#.###.#.#.#.#.#####.#.###############.#######.###.#########.###.###########
###...#####...#...#.............#...#..E###########...#...#####...#...#.#.#.#.#.#...#...#...#...###...#.......#...#.....#...#.#...#...#...###
###.#.#######.#####.###########.#.#.#################.#.#############.#.#.#.#.#.#.#.#####.#.#.#.###.#.#######.###.#####.#.#.#.#.###.#.#.#.###
#...#...#...#...#...###...#...#...#.......###########.#.#...#...#.....#.#.#...#...#.#.....#...#.#...#.........###.....#...#...#.....#...#...#
#.#####.#.#.###.#.#####.#.#.#.###########.###########.#.#.#.#.#.#.#####.#.#########.#.#########.#.###################.#####################.#
#.....#...#.....#.#.....#...#.............###########.#...#.#.#.#.....#.#...#.......#.....#.....#...................#.....#.............#...#
#####.###########.#.#################################.#####.#.#.#####.#.###.#.###########.#.#######################.#####.#.###########.#.###
#...#...#...#...#.#.....#.................###...#####.#.....#.#.....#.#.#...#...#...#.....#...#...#.....#...#.....#.....#.#...........#...###
#.#.###.#.#.#.#.#.#####.#.###############.###.#.#####.#.#####.#####.#.#.#.#####.#.#.#.#######.#.#.#.###.#.#.#.###.#####.#.###########.#######
#.#.....#.#...#.#.#...#...###...#.........#...#.....#.#...###.#.....#.#.#.....#.#.#.#.#.......#.#.#...#...#.#...#.#...#.#.#.....#...#...#...#
#.#######.#####.#.#.#.#######.#.#.#########.#######.#.###.###.#.#####.#.#####.#.#.#.#.#.#######.#.###.#####.###.#.#.#.#.#.#.###.#.#.###.#.#.#
#.........#.....#.#.#.........#.#.........#.#...#...#...#...#.#...#...#...#...#.#.#...#...#...#.#...#.....#.#...#.#.#...#...###.#.#...#...#.#
###########.#####.#.###########.#########.#.#.#.#.#####.###.#.###.#.#####.#.###.#.#######.#.#.#.###.#####.#.#.###.#.###########.#.###.#####.#
#...###...#.......#...........#.#.........#.#.#...#...#...#.#.#...#.....#.#.#...#...#.....#.#.#...#.#...#.#...###...###...#...#.#.###.....#.#
#.#.###.#.###################.#.#.#########.#.#####.#.###.#.#.#.#######.#.#.#.#####.#.#####.#.###.#.#.#.#.#############.#.#.#.#.#.#######.#.#
#.#...#.#...#.....#...#.......#.#.....#.....#.#...#.#...#.#.#.#...#.....#.#.#.#...#.#.#...#.#...#.#.#.#.#...............#...#.#.#.....#...#.#
#.###.#.###.#.###.#.#.#.#######.#####.#.#####.#.#.#.###.#.#.#.###.#.#####.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#####################.#.#####.#.###.#
#...#...#...#...#.#.#.#...#...#.......#...#...#.#.#.#...#.#.#...#.#...#...#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.........#.....#...#.#.....#.#.#...#
###.#####.#####.#.#.#.###.#.#.###########.#.###.#.#.#.###.#.###.#.###.#.###.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#######.#.###.#.#.#.#####.#.#.#.###
###.....#.......#...#.....#.#...#...#.....#...#.#.#.#...#.#.#...#...#.#.#...#...#.#.#.#.#.#.#.#...#.#.#.#.....###...###...#...#...#...#...###
#######.###################.###.#.#.#.#######.#.#.#.###.#.#.#.#####.#.#.#.#######.#.#.#.#.#.#.#.###.#.#.#####.#################.#.###########
#...#...#.....#.....#.....#.#...#.#.#.#.......#.#.#.###.#.#.#...#...#.#.#.#...#...#.#...#.#.#.#.#...#.#.#...#.......#...#...###.#.......#...#
#.#.#.###.###.#.###.#.###.#.#.###.#.#.#.#######.#.#.###.#.#.###.#.###.#.#.#.#.#.###.#####.#.#.#.#.###.#.#.#.#######.#.#.#.#.###.#######.#.#.#
#.#...#...#...#.###...###...#...#.#.#.#...#...#.#.#.#...#.#...#.#...#.#.#...#.#...#...###.#.#...#.#...#.#.#.......#...#.#.#.....#...#...#.#.#
#.#####.###.###.###############.#.#.#.###.#.#.#.#.#.#.###.###.#.###.#.#.#####.###.###.###.#.#####.#.###.#.#######.#####.#.#######.#.#.###.#.#
#.#...#.###...#.........#.....#...#.#...#...#.#.#...#...#.###.#.###.#.#...#...###.#...#...#.....#...###.#.......#.#...#...#.......#.#.....#.#
#.#.#.#.#####.#########.#.###.#####.###.#####.#.#######.#.###.#.###.#.###.#.#####.#.###.#######.#######.#######.#.#.#.#####.#######.#######.#
#.#.#...#.....#.....#...#...#.......#...#...#.#...#.....#.#...#...#.#...#.#.#.....#.#...#.......#.......#.....#.#.#.#.....#.....###.....#...#
#.#.#####.#####.###.#.#####.#########.###.#.#.###.#.#####.#.#####.#.###.#.#.#.#####.#.###.#######.#######.###.#.#.#.#####.#####.#######.#.###
#...#.....#...#...#.#...###...#.....#.....#.#.....#.#...#.#...#...#.#...#...#.#.....#...#.......#.........###...#.#.....#...#...#...###...###
#####.#####.#.###.#.###.#####.#.###.#######.#######.#.#.#.###.#.###.#.#######.#.#######.#######.#################.#####.###.#.###.#.#########
#.....#...#.#.#...#.#...#.....#.###...#...#.....###...#.#.###.#.###...#...###...#.......#.....#.........#####.....#.....###.#.....#.........#
#.#####.#.#.#.#.###.#.###.#####.#####.#.#.#####.#######.#.###.#.#######.#.#######.#######.###.#########.#####.#####.#######.###############.#
#.....#.#...#.#...#.#.#...#.....#...#...#.#...#...#.....#...#.#.........#.#.....#.......#.###...#.....#...#...#...#.###...#.................#
#####.#.#####.###.#.#.#.###.#####.#.#####.#.#.###.#.#######.#.###########.#.###.#######.#.#####.#.###.###.#.###.#.#.###.#.###################
#.....#.###...#...#.#.#...#.#.....#.......#.#.#...#.#...#...#.#...#...#...#...#...#.....#.....#.#...#.#...#.....#.#.....#...................#
#.#####.###.###.###.#.###.#.#.#############.#.#.###.#.#.#.###.#.#.#.#.#.#####.###.#.#########.#.###.#.#.#########.#########################.#
#.#...#.#...#...#...#.###.#.#.....#.......#.#...###...#.#...#.#.#.#.#.#.#...#...#.#.....#...#.#.....#.#...#...#...#...#.....#.....#.......#.#
#.#.#.#.#.###.###.###.###.#.#####.#.#####.#.###########.###.#.#.#.#.#.#.#.#.###.#.#####.#.#.#.#######.###.#.#.#.###.#.#.###.#.###.#.#####.#.#
#.#.#.#.#...#...#.#...#...#...#...#.#.....#...........#...#.#.#.#...#.#.#.#.....#.......#.#...#...###...#...#.#...#.#.#...#.#...#...#...#...#
#.#.#.#.###.###.#.#.###.#####.#.###.#.###############.###.#.#.#.#####.#.#.###############.#####.#.#####.#####.###.#.#.###.#.###.#####.#.#####
#.#.#.#.#...#...#...#...#...#.#.#...#...#...#.....#...#...#.#.#.....#...#.......#...#...#.......#...###...#...#...#.#.#...#...#.......#.....#
#.#.#.#.#.###.#######.###.#.#.#.#.#####.#.#.#.###.#.###.###.#.#####.###########.#.#.#.#.###########.#####.#.###.###.#.#.#####.#############.#
#.#.#.#.#...#.###...#.....#...#.#.....#...#.#.###.#.###...#.#.#...#...#.........#.#...#.#...#.....#.....#.#.#...#...#.#.....#.#.....#.......#
#.#.#.#.###.#.###.#.###########.#####.#####.#.###.#.#####.#.#.#.#.###.#.#########.#####.#.#.#.###.#####.#.#.#.###.###.#####.#.#.###.#.#######
#...#...###.#.#...#.....###.....#.....#.....#...#.#.....#.#.#.#.#.....#.....#...#...###.#.#.#...#...#...#...#...#...#.#.....#...###.#.......#
###########.#.#.#######.###.#####.#####.#######.#.#####.#.#.#.#.###########.#.#.###.###.#.#.###.###.#.#########.###.#.#.###########.#######.#
###...###...#.#...#...#.....#...#.#...#.#...#...#...#...#.#.#.#.........###.#.#...#...#.#.#.#...###.#.....#...#...#.#.#...........#.#.......#
###.#.###.###.###.#.#.#######.#.#.#.#.#.#.#.#.#####.#.###.#.#.#########.###.#.###.###.#.#.#.#.#####.#####.#.#.###.#.#.###########.#.#.#######
#...#.....#...###.#.#...#.....#...#.#...#.#.#.#...#.#.#...#.#.#...#...#...#...###...#.#...#.#.#...#.#...#...#.#...#.#.#...#.....#.#.#.......#
#.#########.#####.#.###.#.#########.#####.#.#.#.#.#.#.#.###.#.#.#.#.#.###.#########.#.#####.#.#.#.#.#.#.#####.#.###.#.#.#.#.###.#.#.#######.#
#.#...#...#.#.....#.#...#.....#.....#...#.#.#...#.#.#.#...#.#.#.#.#.#...#.#.........#.....#.#...#.#.#.#.#...#.#...#.#.#.#.#.#...#.#...#...#.#
#.#.#.#.#.#.#.#####.#.#######.#.#####.#.#.#.#####.#.#.###.#.#.#.#.#.###.#.#.#############.#.#####.#.#.#.#.#.#.###.#.#.#.#.#.#.###.###.#.#.#.#
#...#...#...#.......#.........#.......#...#.......#...###...#...#...###...#...............#.......#...#...#...###...#...#...#.....###...#...#
#############################################################################################################################################'''

example_data = '''###############
#...#...#.....#
#.#.#.#.#.###.#
#S#...#.#.#...#
#######.#.#.###
#######.#.#...#
#######.#.###.#
###..E#...#...#
###.#######.###
#...###...#...#
#.#####.#.###.#
#.#...#.#.#...#
#.#.#.#.#.#.###
#...#...#...###
###############'''


EMPTY = 0
WALL = 1
START = 2
END = 3

def load_data(data):
    map_lines = data.split('\n')
    map = []
    for map_line in map_lines:
        row = []
        for s in map_line:
            if s == '.':
                row.append(EMPTY)
            elif s == '#':
                row.append(WALL)
            elif s == 'S':
                row.append(START)
            else:
                row.append(END)

        map.append(row)
    
    walls = set()
    start = None
    end = None

    for y in range(len(map)):
        for x in range(len(map[0])):
            m = map[y][x]
            if m == WALL:
                walls.add((x,y))
            elif m == START:
                start = (x,y)
            elif m == END:
                end = (x,y)

    return walls, start, end


def find_honest_path(walls, start, end):
    # relies on the fact that there is only one path that avoids walls
    path = [start]
    last_dir = None

    position = start
    while position != end:
        for d in range(4):
            if (d + 2) % 4 == last_dir:
                # don't go back the way you came
                continue

            candidate = step(position, d)
            if candidate not in walls:
                path.append(candidate)
                last_dir = d
                position = candidate
                break
    
    return path


def find_cheat_paths(honest_path, cheat_time):
    honest_path_length = len(honest_path)
    cheat_paths = dict()

    for cheat_start_index in range(honest_path_length - 4):
        for cheat_end_index in range(cheat_start_index + 4, honest_path_length):
            cheat_start = honest_path[cheat_start_index]
            cheat_end = honest_path[cheat_end_index]
            dist = distance(cheat_start, cheat_end)
            if dist > cheat_time:
                continue

            # found a new cheat path
            shortcut = (cheat_start, cheat_end)
            steps_skipped = cheat_end_index - cheat_start_index
            cheat_paths[shortcut] = (steps_skipped, dist)

    return cheat_paths


def step(position, direction):
    x = position[0] + (direction % 2) * (-direction + 2)
    y = position[1] + ((direction + 1) % 2) * (direction - 1)
    return (x,y)


def distance(start, end):
    return abs(end[0] - start[0]) + abs(end[1] - start[1])


def p1():
    print('part 1')
    walls, start, end = load_data(data)

    honest_path = find_honest_path(walls, start, end)

    cheat_paths = find_cheat_paths(honest_path, 2)

    cheats_saving_100_picoseconds = 0
    for shortcut in cheat_paths.keys():
        stats = cheat_paths[shortcut]
        if stats[0] - stats[1] >= 100:
            cheats_saving_100_picoseconds += 1
    
    print(cheats_saving_100_picoseconds)


def p2():
    print('part 2')
    walls, start, end = load_data(data)

    honest_path = find_honest_path(walls, start, end)

    cheat_paths = find_cheat_paths(honest_path, 20)

    cheats_saving_100_picoseconds = 0
    for shortcut in cheat_paths.keys():
        stats = cheat_paths[shortcut]
        if stats[0] - stats[1] >= 100:
            cheats_saving_100_picoseconds += 1
    
    print(cheats_saving_100_picoseconds)


p2()
